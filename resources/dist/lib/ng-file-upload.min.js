window.XMLHttpRequest&&(!window.FileAPI||!FileAPI.shouldLoad)&&(window.XMLHttpRequest.prototype.setRequestHeader=function(a){return function(d,b){if(d==="__setXHR_"){var c=b(this);c instanceof Function&&c(this)}else a.apply(this,arguments)}}(window.XMLHttpRequest.prototype.setRequestHeader));var ngFileUpload=angular.module("ngFileUpload",[]);ngFileUpload.version="12.0.4",ngFileUpload.service("UploadBase",["$http","$q","$timeout",function(g,b,d){function e(j){function l(n){h.notify&&h.notify(n),m.progressFunc&&d(function(){m.progressFunc(n)})}function i(o){return j._start!=null&&a?{loaded:o.loaded+j._start,total:j._file&&j._file.size||o.total,type:o.type,config:j,lengthComputable:!0,target:o.target}:o}function k(){g(j).then(function(n){a&&j._chunkSize&&!j._finished&&j._file?(l({loaded:j._end,total:j._file&&j._file.size,config:j,type:"progress"}),c.upload(j,!0)):(j._finished&&delete j._finished,h.resolve(n))},function(n){h.reject(n)},function(o){h.notify(o)})}j.method=j.method||"POST",j.headers=j.headers||{};var h=j._deferred=j._deferred||b.defer(),m=h.promise;return j.disableProgress||(j.headers.__setXHR_=function(){return function(n){if(!n||!n.upload||!n.upload.addEventListener)return;j.__XHR=n,j.xhrFn&&j.xhrFn(n),n.upload.addEventListener("progress",function(o){o.config=j,l(i(o))},!1),n.upload.addEventListener("load",function(o){o.lengthComputable&&(o.config=j,l(i(o)))},!1)}}),a?j._chunkSize&&j._end&&!j._finished?(j._start=j._end,j._end+=j._chunkSize,k()):j.resumeSizeUrl?g.get(j.resumeSizeUrl).then(function(n){j.resumeSizeResponseReader?j._start=j.resumeSizeResponseReader(n.data):j._start=parseInt((n.data.size==null?n.data:n.data.size).toString()),j._chunkSize&&(j._end=j._start+j._chunkSize),k()},function(n){throw n}):j.resumeSize?j.resumeSize().then(function(n){j._start=n,k()},function(n){throw n}):(j._chunkSize&&(j._start=0,j._end=j._start+j._chunkSize),k()):k(),m.success=function(n){return m.then(function(o){n(o.data,o.status,o.headers,j)}),m},m.error=function(n){return m.then(null,function(o){n(o.data,o.status,o.headers,j)}),m},m.progress=function(n){return m.progressFunc=n,m.then(null,null,function(o){n(o)}),m},m.abort=m.pause=function(){return j.__XHR&&d(function(){j.__XHR.abort()}),m},m.xhr=function(n){return j.xhrFn=function(o){return function(){o&&o.apply(m,arguments),n.apply(m,arguments)}}(j.xhrFn),m},c.promisesCount++,m["finally"](function(){c.promisesCount--}),m}function f(i){var j={};for(var h in i)i.hasOwnProperty(h)&&(j[h]=i[h]);return j}var c=this;c.promisesCount=0,this.isResumeSupported=function(){return window.Blob&&window.Blob.prototype.slice};var a=this.isResumeSupported();this.isUploadInProgress=function(){return c.promisesCount>0},this.rename=function(i,h){return i.ngfName=h,i},this.jsonBlob=function(i){i!=null&&!angular.isString(i)&&(i=JSON.stringify(i));var h=new window.Blob([i],{type:"application/json"});return h._ngfBlob=!0,h},this.json=function(h){return angular.toJson(h)},this.isFile=function(h){return h!=null&&(h instanceof window.Blob||h.flashId&&h.name&&h.size)},this.upload=function(i,h){function k(m,n){if(m._ngfBlob)return m;i._file=i._file||m;if(i._start!=null&&a){i._end&&i._end>=m.size&&(i._finished=!0,i._end=m.size);var o=m.slice(i._start,i._end||m.size);return o.name=m.name,o.ngfName=m.ngfName,i._chunkSize&&(n.append("_chunkSize",i._chunkSize),n.append("_currentChunkSize",i._end-i._start),n.append("_chunkNumber",Math.floor(i._start/i._chunkSize)),n.append("_totalSize",i._file.size)),o}return m}function j(r,s,q){if(s!==undefined){angular.isDate(s)&&(s=s.toISOString());if(angular.isString(s))r.append(q,s);else if(c.isFile(s)){var p=k(s,r),o=q.split(",");o[1]&&(p.ngfName=o[1].replace(/^\s+|\s+$/g,""),q=o[0]),i._fileKey=i._fileKey||q,r.append(q,p,p.ngfName||p.name)}else if(angular.isObject(s)){if(s.$$ngfCircularDetection)throw"ngFileUpload: Circular reference in config.data. Make sure specified data for Upload.upload() has no circular reference: "+q;s.$$ngfCircularDetection=!0;try{for(var m in s)if(s.hasOwnProperty(m)&&m!=="$$ngfCircularDetection"){var n=i.objectKey==null?"[i]":i.objectKey;s.length&&parseInt(m)>-1&&(n=i.arrayKey==null?n:i.arrayKey),j(r,s[m],q+n.replace(/[ik]/g,m))}}finally{delete s.$$ngfCircularDetection}}else r.append(q,s)}}function l(){i._chunkSize=c.translateScalars(i.resumeChunkSize),i._chunkSize=i._chunkSize?parseInt(i._chunkSize.toString()):null,i.headers=i.headers||{},i.headers["Content-Type"]=undefined,i.transformRequest=i.transformRequest?angular.isArray(i.transformRequest)?i.transformRequest:[i.transformRequest]:[],i.transformRequest.push(function(n){var o=new window.FormData,m;n=n||i.fields||{},i.file&&(n.file=i.file);for(m in n)if(n.hasOwnProperty(m)){var p=n[m];i.formDataAppender?i.formDataAppender(o,m,p):j(o,p,m)}return o})}return h||(i=f(i)),i._isDigested||(i._isDigested=!0,l()),e(i)},this.http=function(h){return h=f(h),h.transformRequest=h.transformRequest||function(i){return window.ArrayBuffer&&i instanceof window.ArrayBuffer||i instanceof window.Blob?i:g.defaults.transformRequest[0].apply(this,arguments)},h._chunkSize=c.translateScalars(h.resumeChunkSize),h._chunkSize=h._chunkSize?parseInt(h._chunkSize.toString()):null,e(h)},this.translateScalars=function(h){if(angular.isString(h)){if(h.search(/kb/i)===h.length-2)return parseFloat(h.substring(0,h.length-2)*1024);if(h.search(/mb/i)===h.length-2)return parseFloat(h.substring(0,h.length-2)*1048576);if(h.search(/gb/i)===h.length-2)return parseFloat(h.substring(0,h.length-2)*1073741824);if(h.search(/b/i)===h.length-1)return parseFloat(h.substring(0,h.length-1));if(h.search(/s/i)===h.length-1)return parseFloat(h.substring(0,h.length-1));if(h.search(/m/i)===h.length-1)return parseFloat(h.substring(0,h.length-1)*60);if(h.search(/h/i)===h.length-1)return parseFloat(h.substring(0,h.length-1)*3600)}return h},this.urlToBlob=function(h){var i=b.defer();return g({url:h,method:"get",responseType:"arraybuffer"}).then(function(m){var l=new Uint8Array(m.data),k=m.headers("content-type")||"image/WebP",j=new window.Blob([l],{type:k});i.resolve(j)},function(j){i.reject(j)}),i.promise},this.setDefaults=function(h){this.defaults=h||{}},this.defaults={},this.version=ngFileUpload.version}]),ngFileUpload.service("Upload",["$parse","$timeout","$compile","$q","UploadExif",function(d,c,f,h,e){function g(m,j,l){var k=[i.emptyPromise()];return angular.forEach(m,function(o,n){o.type.indexOf("image/jpeg")===0&&i.attrGetter("ngfFixOrientation",j,l,{$file:o})&&k.push(i.happyPromise(i.applyExifRotation(o),o).then(function(p){m.splice(n,1,p)}))}),h.all(k)}function a(m,k,l){var j=i.attrGetter("ngfResize",k,l);if(!j||!i.isResizeSupported()||!m.length)return i.emptyPromise();if(!(j instanceof Function))return b(j,m,k,l);var n=h.defer();j(m).then(function(o){b(o,m,k,l).then(function(p){n.resolve(p)},function(p){n.reject(p)})},function(o){n.reject(o)})}function b(p,o,j,n){function k(r,q){if(r.type.indexOf("image")===0){if(p.pattern&&!i.validatePattern(r,p.pattern))return;var s=i.resize(r,p.width,p.height,p.quality,p.type,p.ratio,p.centerCrop,function(u,t){return i.attrGetter("ngfResizeIf",j,n,{$width:u,$height:t,$file:r})},p.restoreExif!==!1);m.push(s),s.then(function(t){o.splice(q,1,t)},function(t){r.$error="resize",r.$errorParam=(t?(t.message?t.message:t)+": ":"")+(r&&r.name)})}}var m=[i.emptyPromise()];for(var l=0;l<o.length;l++)k(o[l],l);return h.all(m)}var i=e;return i.getAttrWithDefaults=function(j,k){if(j[k]!=null)return j[k];var l=i.defaults[k];return l==null?l:angular.isString(l)?l:JSON.stringify(l)},i.attrGetter=function(l,j,m,o){var k=this.getAttrWithDefaults(j,l);if(!m)return k;try{return o?d(k)(m,o):d(k)(m)}catch(n){if(l.search(/min|max|pattern/i))return k;throw n}},i.shouldUpdateOn=function(l,j,k){var m=i.attrGetter("ngModelOptions",j,k);return m&&m.updateOn?m.updateOn.split(" ").indexOf(l)>-1:!0},i.emptyPromise=function(){var k=h.defer(),j=arguments;return c(function(){k.resolve.apply(k,j)}),k.promise},i.rejectPromise=function(){var k=h.defer(),j=arguments;return c(function(){k.reject.apply(k,j)}),k.promise},i.happyPromise=function(l,j){var k=h.defer();return l.then(function(m){k.resolve(m)},function(m){c(function(){throw m}),k.resolve(j)}),k.promise},i.updateModel=function(s,x,k,j,o,t,n){function p(J,M,K,L,H){x.$$ngfPrevValidFiles=J,x.$$ngfPrevInvalidFiles=M;var G=J&&J.length?J[0]:null,F=M&&M.length?M[0]:null;s&&(i.applyModelValidation(s,J),s.$setViewValue(H?G:J)),j&&d(j)(k,{$files:J,$file:G,$newFiles:K,$duplicateFiles:L,$invalidFiles:M,$invalidFile:F,$event:t});var I=i.attrGetter("ngfModelInvalid",x);I&&c(function(){d(I).assign(k,H?F:M)}),c(function(){})}function D(){function H(I,J){return I.name===J.name&&(I.$ngfOrigSize||I.size)===(J.$ngfOrigSize||J.size)&&I.type===J.type}function F(J){var I;for(I=0;I<u.length;I++)if(H(J,u[I]))return!0;for(I=0;I<y.length;I++)if(H(J,y[I]))return!0;return!1}if(o){q=[],v=[];for(var G=0;G<o.length;G++)F(o[G])?v.push(o[G]):q.push(o[G])}}function z(F){return angular.isArray(F)?F:[F]}function B(){l=[],r=[],angular.forEach(q,function(F){F.$error?r.push(F):l.push(F)})}function E(){function F(){c(function(){p(A?u.concat(l):l,A?y.concat(r):r,o,v,w)},m&&m.debounce?m.debounce.change||m.debounce:0)}a(C?q:l,x,k).then(function(){C?i.validate(q,u.length,s,x,k).then(function(){B(),F()}):F()},function(G){throw"Could not resize files "+G})}var q,v=[],u,y,r=[],l=[];u=x.$$ngfPrevValidFiles||[],y=x.$$ngfPrevInvalidFiles||[],s&&s.$modelValue&&(u=z(s.$modelValue));var A=i.attrGetter("ngfKeep",x,k);q=(o||[]).slice(0),(A==="distinct"||i.attrGetter("ngfKeepDistinct",x,k)===!0)&&D(x,k);var w=!A&&!i.attrGetter("ngfMultiple",x,k)&&!i.attrGetter("multiple",x);if(A&&!q.length)return;i.attrGetter("ngfBeforeModelChange",x,k,{$files:o,$file:o&&o.length?o[0]:null,$newFiles:q,$duplicateFiles:v,$event:t});var C=i.attrGetter("ngfValidateAfterResize",x,k),m=i.attrGetter("ngModelOptions",x,k);i.validate(q,u.length,s,x,k).then(function(){n?p(q,[],o,v,w):((!m||!m.allowInvalid)&&!C?B():l=q,i.attrGetter("ngfFixOrientation",x,k)&&i.isExifSupported()?g(l,x,k).then(function(){E()}):E())})},i}]),ngFileUpload.directive("ngfSelect",["$parse","$timeout","$compile","Upload",function(g,f,e,b){function c(j){var h=j.match(/Android[^\d]*(\d+)\.(\d+)/);if(h&&h.length>2){var i=b.defaults.androidFixMinorVersion||4;return parseInt(h[1])<4||parseInt(h[1])===i&&parseInt(h[2])<i}return j.indexOf("Chrome")===-1&&/.*Windows.*Safari.*/.test(j)}function a(h,w,s,n,j,z,v,x){function r(){return w[0].tagName.toLowerCase()==="input"&&s.type&&s.type.toLowerCase()==="file"}function A(){return k("ngfChange")||k("ngfSelect")}function i(C){if(x.shouldUpdateOn("change",s,h)){var D=C.__files_||C.target&&C.target.files,F=[];for(var E=0;E<D.length;E++)F.push(D[E]);x.updateModel(n,s,h,A(),F.length?F:null,C)}}function y(C){if(w!==C)for(var D=0;D<w[0].attributes.length;D++){var E=w[0].attributes[D];if(E.name!=="type"&&E.name!=="class"&&E.name!=="style"){if(E.value==null||E.value==="")E.name==="required"&&(E.value="required"),E.name==="multiple"&&(E.value="multiple");C.attr(E.name,E.name==="id"?"ngf-"+E.value:E.value)}}}function l(){if(r())return w;var C=angular.element('<input type="file">');y(C);var D=angular.element("<label>upload</label>");return D.css("visibility","hidden").css("position","absolute").css("overflow","hidden").css("width","0px").css("height","0px").css("border","none").css("margin","0px").css("padding","0px").attr("tabindex","-1"),d.push({el:w,ref:D}),document.body.appendChild(D.append(C)[0]),C}function m(C){if(w.attr("disabled"))return!1;if(k("ngfSelectDisabled",h))return;var D=B(C);if(D!=null)return D;t(C);try{!r()&&!document.body.contains(u[0])&&(d.push({el:w,ref:u.parent()}),document.body.appendChild(u.parent()[0]),u.bind("change",i))}catch(E){}return c(navigator.userAgent)?setTimeout(function(){u[0].click()},0):u[0].click(),!1}function B(C){var E=C.changedTouches||C.originalEvent&&C.originalEvent.changedTouches;if(C.type==="touchstart")return o=E?E[0].clientY:0,!0;C.stopPropagation(),C.preventDefault();if(C.type==="touchend"){var D=E?E[0].clientY:0;if(Math.abs(D-o)>20)return!1}}function t(C){x.shouldUpdateOn("click",s,h)&&u.val()&&(u.val(null),x.updateModel(n,s,h,A(),null,C,!0))}function p(C){if(u&&!u.attr("__ngf_ie10_Fix_")){if(!u[0].parentNode){u=null;return}C.preventDefault(),C.stopPropagation(),u.unbind("click");var D=u.clone();return u.replaceWith(D),u=D,u.attr("__ngf_ie10_Fix_","true"),u.bind("change",i),u.bind("click",p),u[0].click(),!1}u.removeAttr("__ngf_ie10_Fix_")}var k=function(C,D){return x.attrGetter(C,s,D)};x.registerModelChangeValidator(n,s,h);var q=[];q.push(h.$watch(k("ngfMultiple"),function(){u.attr("multiple",k("ngfMultiple",h))})),q.push(h.$watch(k("ngfCapture"),function(){u.attr("capture",k("ngfCapture",h))})),q.push(h.$watch(k("ngfAccept"),function(){u.attr("accept",k("ngfAccept",h))})),s.$observe("accept",function(){u.attr("accept",k("accept"))}),q.push(function(){s.$$observers&&delete s.$$observers.accept});var o=0,u=w;r()||(u=l()),u.bind("change",i),r()?w.bind("click",t):w.bind("click touchstart touchend",m),navigator.appVersion.indexOf("MSIE 10")!==-1&&u.bind("click",p),n&&n.$formatters.push(function(C){return(C==null||C.length===0)&&u.val()&&u.val(null),C}),h.$on("$destroy",function(){r()||u.parent().remove(),angular.forEach(q,function(C){C()})}),z(function(){for(var C=0;C<d.length;C++){var D=d[C];document.body.contains(D.el[0])||(d.splice(C,1),D.ref.remove())}}),window.FileAPI&&window.FileAPI.ngfFixIE&&window.FileAPI.ngfFixIE(w,u,i)}var d=[];return{restrict:"AEC",require:"?ngModel",link:function(i,j,h,k){a(i,j,h,k,g,f,e,b)}}}]),function(){function b(c){return c.tagName.toLowerCase()==="img"?"image":c.tagName.toLowerCase()==="audio"?"audio":c.tagName.toLowerCase()==="video"?"video":/./}function a(e,c,k,d,h,f,g,i){function j(l){var m=e.attrGetter("ngfNoObjectUrl",h,k);e.dataUrl(l,m)["finally"](function(){c(function(){var n=(m?l.$ngfDataUrl:l.$ngfBlobUrl)||l.$ngfDataUrl;i?d.css("background-image","url('"+(n||"")+"')"):d.attr("src",n),n?d.removeClass("ng-hide"):d.addClass("ng-hide")})})}c(function(){var l=k.$watch(h[f],function(n){var m=g;if(f==="ngfThumbnail"){m||(m={width:d[0].clientWidth,height:d[0].clientHeight});if(m.width===0&&window.getComputedStyle){var o=getComputedStyle(d[0]);m={width:parseInt(o.width.slice(0,-2)),height:parseInt(o.height.slice(0,-2))}}}if(angular.isString(n))return d.removeClass("ng-hide"),i?d.css("background-image","url('"+n+"')"):d.attr("src",n);n&&n.type&&n.type.search(b(d[0]))===0&&(!i||n.type.indexOf("image")===0)?m&&e.isResizeSupported()?e.resize(n,m.width,m.height,m.quality).then(function(p){j(p)},function(p){throw p}):j(n):d.addClass("ng-hide")});k.$on("$destroy",function(){l()})})}ngFileUpload.service("UploadDataUrl",["UploadBase","$timeout","$q",function(f,e,c){var d=f;return d.base64DataUrl=function(g){if(angular.isArray(g)){var i=c.defer(),h=0;return angular.forEach(g,function(j){d.dataUrl(j,!0)["finally"](function(){h++;if(h===g.length){var k=[];angular.forEach(g,function(l){k.push(l.$ngfDataUrl)}),i.resolve(k,g)}})}),i.promise}return d.dataUrl(g,!0)},d.dataUrl=function(h,i){if(!h)return d.emptyPromise(h,h);if(i&&h.$ngfDataUrl!=null||!i&&h.$ngfBlobUrl!=null)return d.emptyPromise(i?h.$ngfDataUrl:h.$ngfBlobUrl,h);var j=i?h.$$ngfDataUrlPromise:h.$$ngfBlobUrlPromise;if(j)return j;var g=c.defer();return e(function(){if(window.FileReader&&h&&(!window.FileAPI||navigator.userAgent.indexOf("MSIE 8")===-1||h.size<2e4)&&(!window.FileAPI||navigator.userAgent.indexOf("MSIE 9")===-1||h.size<4e6)){var k=window.URL||window.webkitURL;if(k&&k.createObjectURL&&!i){var m;try{m=k.createObjectURL(h)}catch(n){e(function(){h.$ngfBlobUrl="",g.reject()});return}e(function(){h.$ngfBlobUrl=m;if(m){g.resolve(m,h),d.blobUrls=d.blobUrls||[],d.blobUrlsTotalSize=d.blobUrlsTotalSize||0,d.blobUrls.push({url:m,size:h.size}),d.blobUrlsTotalSize+=h.size||0;var p=d.defaults.blobUrlsMaxMemory||268435456,o=d.defaults.blobUrlsMaxQueueSize||200;while((d.blobUrlsTotalSize>p||d.blobUrls.length>o)&&d.blobUrls.length>1){var q=d.blobUrls.splice(0,1)[0];k.revokeObjectURL(q.url),d.blobUrlsTotalSize-=q.size}}})}else{var l=new FileReader;l.onload=function(o){e(function(){h.$ngfDataUrl=o.target.result,g.resolve(o.target.result,h),e(function(){delete h.$ngfDataUrl},1e3)})},l.onerror=function(){e(function(){h.$ngfDataUrl="",g.reject()})},l.readAsDataURL(h)}}else e(function(){h[i?"$ngfDataUrl":"$ngfBlobUrl"]="",g.reject()})}),i?j=h.$$ngfDataUrlPromise=g.promise:j=h.$$ngfBlobUrlPromise=g.promise,j["finally"](function(){delete h[i?"$$ngfDataUrlPromise":"$$ngfBlobUrlPromise"]}),j},d}]),ngFileUpload.directive("ngfSrc",["Upload","$timeout",function(c,d){return{restrict:"AE",link:function(f,g,e){a(c,d,f,g,e,"ngfSrc",c.attrGetter("ngfResize",e,f),!1)}}}]),ngFileUpload.directive("ngfBackground",["Upload","$timeout",function(c,d){return{restrict:"AE",link:function(f,g,e){a(c,d,f,g,e,"ngfBackground",c.attrGetter("ngfResize",e,f),!0)}}}]),ngFileUpload.directive("ngfThumbnail",["Upload","$timeout",function(c,d){return{restrict:"AE",link:function(g,h,e){var f=c.attrGetter("ngfSize",e,g);a(c,d,g,h,e,"ngfThumbnail",f,c.attrGetter("ngfAsBackground",e,g))}}}]),ngFileUpload.config(["$compileProvider",function(c){c.imgSrcSanitizationWhitelist&&c.imgSrcSanitizationWhitelist(/^\s*(https?|ftp|mailto|tel|local|file|data|blob):/),c.aHrefSanitizationWhitelist&&c.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|tel|local|file|data|blob):/)}]),ngFileUpload.filter("ngfDataUrl",["UploadDataUrl","$sce",function(d,c){return function(e,g,f){if(angular.isString(e))return c.trustAsResourceUrl(e);var h=e&&((g?e.$ngfDataUrl:e.$ngfBlobUrl)||e.$ngfDataUrl);return e&&!h?(!e.$ngfDataUrlFilterInProgress&&angular.isObject(e)&&(e.$ngfDataUrlFilterInProgress=!0,d.dataUrl(e,g)),""):(e&&delete e.$ngfDataUrlFilterInProgress,(e&&h?f?c.trustAsResourceUrl(h):h:e)||"")}}])}(),ngFileUpload.service("UploadValidate",["UploadDataUrl","$q","$timeout",function(f,a,c){function e(l){var k="",m=[];if(l.length>2&&l[0]==="/"&&l[l.length-1]==="/")k=l.substring(1,l.length-1);else{var h=l.split(",");if(h.length>1)for(var g=0;g<h.length;g++){var j=e(h[g]);j.regexp?(k+="("+j.regexp+")",g<h.length-1&&(k+="|")):m=m.concat(j.excludes)}else l.indexOf("!")===0?m.push("^((?!"+e(l.substring(1)).regexp+").)*$"):(l.indexOf(".")===0&&(l="*"+l),k="^"+l.replace(new RegExp("[.\\\\+*?\\[\\^\\]$(){}=!<>|:\\-]","g"),"\\$&")+"$",k=k.replace(/\\\*/g,".*").replace(/\\\?/g,"."))}return{regexp:k,excludes:m}}function d(h,g){g!=null&&!h.$dirty&&(h.$setDirty?h.$setDirty():h.$dirty=!0)}var b=f;return b.validatePattern=function(i,m){if(!m)return!0;var l=e(m),j=!0;if(l.regexp&&l.regexp.length){var k=new RegExp(l.regexp,"i");j=i.type!=null&&k.test(i.type)||i.name!=null&&k.test(i.name)}var g=l.excludes.length;while(g--){var h=new RegExp(l.excludes[g],"i");j=j&&(i.type==null||h.test(i.type))&&(i.name==null||h.test(i.name))}return j},b.ratioToFloat=function(i){var h=i.toString(),g=h.search(/[x:]/i);return g>-1?h=parseFloat(h.substring(0,g))/parseFloat(h.substring(g+1)):h=parseFloat(h),h},b.registerModelChangeValidator=function(i,g,h){i&&i.$formatters.push(function(j){i.$dirty&&(j&&!angular.isArray(j)&&(j=[j]),b.validate(j,0,i,g,h).then(function(){b.applyModelValidation(i,j)}))})},b.applyModelValidation=function(h,g){d(h,g),angular.forEach(h.$ngfValidations,function(i){h.$setValidity(i.name,i.valid)})},b.getValidationAttr=function(g,k,h,n,j){var l="ngf"+h[0].toUpperCase()+h.substr(1),m=b.attrGetter(l,g,k,{$file:j});if(m==null){m=b.attrGetter("ngfValidate",g,k,{$file:j});if(m){var i=(n||h).split(".");m=m[i[0]],i.length>1&&(m=m&&m[i[1]])}}return m},b.validate=function(g,k,i,l,q){function j(r,x,u){if(g){var t=g.length,v=null;while(t--){var s=g[t];if(s){var w=b.getValidationAttr(l,q,r,x,s);w!=null&&(u(s,w,t)||(s.$error=r,(s.$errorMessages=s.$errorMessages||{})[r]=!0,s.$errorParam=w,g.splice(t,1),v=!1))}}v!==null&&i.$ngfValidations.push({name:r,valid:v})}}function n(s,x,v,r,u){function w(A,y,z){z!=null?r(y,z).then(function(B){u(B,z)?A.resolve():(y.$error=s,(y.$errorMessages=y.$errorMessages||{})[s]=!0,y.$errorParam=z,A.reject())},function(){o("ngfValidateForce",{$file:y})?(y.$error=s,(y.$errorMessages=y.$errorMessages||{})[s]=!0,y.$errorParam=z,A.reject()):A.resolve()}):A.resolve()}var t=[b.emptyPromise()];if(g)return g=g.length===undefined?[g]:g,angular.forEach(g,function(y){var z=a.defer();t.push(z.promise);if(!(!v||y.type!=null&&y.type.search(v)===0)){z.resolve();return}s==="dimensions"&&b.attrGetter("ngfDimensions",l)!=null?b.imageDimensions(y).then(function(A){w(z,y,o("ngfDimensions",{$file:y,$width:A.width,$height:A.height}))},function(){z.reject()}):s==="duration"&&b.attrGetter("ngfDuration",l)!=null?b.mediaDuration(y).then(function(A){w(z,y,o("ngfDuration",{$file:y,$duration:A}))},function(){z.reject()}):w(z,y,b.getValidationAttr(l,q,s,x,y))}),a.all(t).then(function(){i.$ngfValidations.push({name:s,valid:!0})},function(){i.$ngfValidations.push({name:s,valid:!1})})}i=i||{},i.$ngfValidations=i.$ngfValidations||[],angular.forEach(i.$ngfValidations,function(r){r.valid=!0});var o=function(r,s){return b.attrGetter(r,l,q,s)};if(g==null||g.length===0)return b.emptyPromise(i);g=g.length===undefined?[g]:g.slice(0),j("maxFiles",null,function(s,t,r){return k+r<t}),j("pattern",null,b.validatePattern),j("minSize","size.min",function(r,s){return r.size+.1>=b.translateScalars(s)}),j("maxSize","size.max",function(r,s){return r.size-.1<=b.translateScalars(s)});var p=0;j("maxTotalSize",null,function(r,s){return p+=r.size,p>b.translateScalars(s)?(g.splice(0,g.length),!1):!0}),j("validateFn",null,function(s,t){return t===!0||t===null||t===""});if(!g.length)return b.emptyPromise(i,i.$ngfValidations);var h=a.defer(),m=[];return m.push(b.happyPromise(n("maxHeight","height.max",/image/,this.imageDimensions,function(s,r){return s.height<=r}))),m.push(b.happyPromise(n("minHeight","height.min",/image/,this.imageDimensions,function(s,r){return s.height>=r}))),m.push(b.happyPromise(n("maxWidth","width.max",/image/,this.imageDimensions,function(s,r){return s.width<=r}))),m.push(b.happyPromise(n("minWidth","width.min",/image/,this.imageDimensions,function(s,r){return s.width>=r}))),m.push(b.happyPromise(n("dimensions",null,/image/,function(r,s){return b.emptyPromise(s)},function(s){return s}))),m.push(b.happyPromise(n("ratio",null,/image/,this.imageDimensions,function(v,u){var s=u.toString().split(","),t=!1;for(var r=0;r<s.length;r++)Math.abs(v.width/v.height-b.ratioToFloat(s[r]))<1e-4&&(t=!0);return t}))),m.push(b.happyPromise(n("maxRatio","ratio.max",/image/,this.imageDimensions,function(s,r){return s.width/s.height-b.ratioToFloat(r)<1e-4}))),m.push(b.happyPromise(n("minRatio","ratio.min",/image/,this.imageDimensions,function(s,r){return s.width/s.height-b.ratioToFloat(r)>-0.0001}))),m.push(b.happyPromise(n("maxDuration","duration.max",/audio|video/,this.mediaDuration,function(s,r){return s<=b.translateScalars(r)}))),m.push(b.happyPromise(n("minDuration","duration.min",/audio|video/,this.mediaDuration,function(s,r){return s>=b.translateScalars(r)}))),m.push(b.happyPromise(n("duration",null,/audio|video/,function(r,s){return b.emptyPromise(s)},function(s){return s}))),m.push(b.happyPromise(n("validateAsyncFn",null,null,function(r,s){return s},function(s){return s===!0||s===null||s===""}))),a.all(m).then(function(){h.resolve(i,i.$ngfValidations)})},b.imageDimensions=function(h){if(h.$ngfWidth&&h.$ngfHeight){var i=a.defer();return c(function(){i.resolve({width:h.$ngfWidth,height:h.$ngfHeight})}),i.promise}if(h.$ngfDimensionPromise)return h.$ngfDimensionPromise;var g=a.defer();return c(function(){if(h.type.indexOf("image")!==0){g.reject("not image");return}b.dataUrl(h).then(function(n){function o(){var q=j[0].clientWidth,p=j[0].clientHeight;j.remove(),h.$ngfWidth=q,h.$ngfHeight=p,g.resolve({width:q,height:p})}function k(){j.remove(),g.reject("load error")}function l(){c(function(){j[0].parentNode&&(j[0].clientWidth?o():m>10?k():l())},1e3)}var j=angular.element("<img>").attr("src",n).css("visibility","hidden").css("position","fixed").css("max-width","none !important").css("max-height","none !important");j.on("load",o),j.on("error",k);var m=0;l(),angular.element(document.getElementsByTagName("body")[0]).append(j)},function(){g.reject("load error")})}),h.$ngfDimensionPromise=g.promise,h.$ngfDimensionPromise["finally"](function(){delete h.$ngfDimensionPromise}),h.$ngfDimensionPromise},b.mediaDuration=function(h){if(h.$ngfDuration){var i=a.defer();return c(function(){i.resolve(h.$ngfDuration)}),i.promise}if(h.$ngfDurationPromise)return h.$ngfDurationPromise;var g=a.defer();return c(function(){if(h.type.indexOf("audio")!==0&&h.type.indexOf("video")!==0){g.reject("not media");return}b.dataUrl(h).then(function(n){function o(){var p=l[0].duration;h.$ngfDuration=p,l.remove(),g.resolve(p)}function j(){l.remove(),g.reject("load error")}function k(){c(function(){l[0].parentNode&&(l[0].duration?o():m>10?j():k())},1e3)}var l=angular.element(h.type.indexOf("audio")===0?"<audio>":"<video>").attr("src",n).css("visibility","none").css("position","fixed");l.on("loadedmetadata",o),l.on("error",j);var m=0;k(),angular.element(document.body).append(l)},function(){g.reject("load error")})}),h.$ngfDurationPromise=g.promise,h.$ngfDurationPromise["finally"](function(){delete h.$ngfDurationPromise}),h.$ngfDurationPromise},b}]),ngFileUpload.service("UploadResize",["UploadValidate","$q",function(d,a){var c=d,e=function(i,f,k,j,h){var g=h?Math.max(k/i,j/f):Math.min(k/i,j/f);return{width:i*g,height:f*g,marginX:i*g-k,marginY:f*g-j}},b=function(n,f,o,m,k,h,g,j){var p=a.defer(),l=document.createElement("canvas"),i=document.createElement("img");return i.onload=function(){if(j!=null&&j(i.width,i.height)===!1){p.reject("resizeIf");return}try{if(h){var u=c.ratioToFloat(h),q=i.width/i.height;q<u?(f=i.width,o=f/u):(o=i.height,f=o*u)}f||(f=i.width),o||(o=i.height);var s=e(i.width,i.height,f,o,g);l.width=Math.min(s.width,f),l.height=Math.min(s.height,o);var r=l.getContext("2d");r.drawImage(i,Math.min(0,-s.marginX/2),Math.min(0,-s.marginY/2),s.width,s.height),p.resolve(l.toDataURL(k||"image/WebP",m||.934))}catch(t){p.reject(t)}},i.onerror=function(){p.reject()},i.src=n,p.promise};return c.dataUrltoBlob=function(m,h,k){var l=m.split(","),g=l[0].match(/:(.*?);/)[1],i=atob(l[1]),j=i.length,o=new Uint8Array(j);while(j--)o[j]=i.charCodeAt(j);var f=new window.Blob([o],{type:g});return f.name=h,f.$ngfOrigSize=k,f},c.isResizeSupported=function(){var f=document.createElement("canvas");return window.atob&&f.getContext&&f.getContext("2d")&&window.Blob},c.isResizeSupported()&&Object.defineProperty(window.Blob.prototype,"name",{get:function(){return this.$ngfName},set:function(f){this.$ngfName=f},configurable:!0}),c.resize=function(h,f,n,m,l,j,i,k,g){if(h.type.indexOf("image")!==0)return c.emptyPromise(h);var o=a.defer();return c.dataUrl(h,!0).then(function(p){b(p,f,n,m,l||h.type,j,i,k).then(function(s){if(h.type==="image/jpeg"&&g)try{s=c.restoreExif(p,s)}catch(r){setTimeout(function(){throw r},1)}try{var q=c.dataUrltoBlob(s,h.name,h.size);o.resolve(q)}catch(r){o.reject(r)}},function(q){q==="resizeIf"&&o.resolve(h),o.reject(q)})},function(p){o.reject(p)}),o.promise},c}]),function(){function b(d,r,n,j,e,v,h,s,w,q){function k(){return r.attr("disabled")||g("ngfDropDisabled",d)}function c(y,x){s.updateModel(j,n,d,g("ngfChange")||g("ngfDrop"),y,x)}function o(A,y){if(!s.shouldUpdateOn(A,n,d)||!y)return s.rejectPromise([]);var B=[];y.replace(/<(img src|img [^>]* src) *=\"([^\"]*)\"/gi,function(D,F,E){B.push(E)});var x=[],z=[];if(B.length){angular.forEach(B,function(D){x.push(s.urlToBlob(D).then(function(E){z.push(E)}))});var C=q.defer();return q.all(x).then(function(){C.resolve(z)},function(D){C.reject(D)}),C.promise}return s.emptyPromise()}function l(F,z,D,E){var x=g("ngfDragOverClass",F,{$event:D}),C="dragover";if(angular.isString(x))C=x;else if(x){x.delay&&(f=x.delay);if(x.accept||x.reject){var B=D.dataTransfer.items;if(B==null||!B.length)C=x.accept;else{var A=x.pattern||g("ngfPattern",F,{$event:D}),y=B.length;while(y--){if(!s.validatePattern(B[y],A)){C=x.reject;break}C=x.accept}}}}E(C)}function t(F,M,K,N){function C(T,U){var V=q.defer();if(T!=null)if(T.isDirectory){var S=[s.emptyPromise()];if(G){var R={type:"directory"};R.name=R.path=(U||"")+T.name+T.name,y.push(R)}var Q=T.createReader(),O=[],P=function(){Q.readEntries(function(W){try{W.length?(O=O.concat(Array.prototype.slice.call(W||[],0)),P()):(angular.forEach(O.slice(0),function(Y){y.length<=L&&J<=E&&S.push(C(Y,(U?U:"")+T.name+"/"))}),q.all(S).then(function(){V.resolve()},function(Y){V.reject(Y)}))}catch(X){V.reject(X)}},function(W){V.reject(W)})};P()}else T.file(function(W){try{W.path=(U?U:"")+W.name,G&&(W=s.rename(W,W.path)),y.push(W),J+=W.size,V.resolve()}catch(X){V.reject(X)}},function(W){V.reject(W)});return V.promise}var L=s.getValidationAttr(n,d,"maxFiles")||Number.MAX_VALUE,E=s.getValidationAttr(n,d,"maxTotalSize")||Number.MAX_VALUE,G=g("ngfIncludeDir",d),y=[],J=0,H=[s.emptyPromise()];if(F&&F.length>0&&h.protocol()!=="file")for(var B=0;B<F.length;B++){if(F[B].webkitGetAsEntry&&F[B].webkitGetAsEntry()&&F[B].webkitGetAsEntry().isDirectory){var I=F[B].webkitGetAsEntry();if(I.isDirectory&&!K)continue;I!=null&&H.push(C(I))}else{var D=F[B].getAsFile();D!=null&&(y.push(D),J+=D.size)}if(y.length>L||J>E||!N&&y.length>0)break}else if(M!=null)for(var A=0;A<M.length;A++){var z=M.item(A);if(z.type||z.size>0)y.push(z),J+=z.size;if(y.length>L||J>E||!N&&y.length>0)break}var x=q.defer();return q.all(H).then(function(){if(!N&&!G&&y.length){var O=0;while(y[O]&&y[O].type==="directory")O++;x.resolve([y[O]])}else x.resolve(y)},function(O){x.reject(O)}),x.promise}var m=a(),g=function(x,y,z){return s.attrGetter(x,n,y,z)};g("dropAvailable")&&v(function(){d[g("dropAvailable")]?d[g("dropAvailable")].value=m:d[g("dropAvailable")]=m});if(!m){g("ngfHideOnDropNotAvailable",d)===!0&&r.css("display","none");return}g("ngfSelect")==null&&s.registerModelChangeValidator(j,n,d);var u=null,i=e(g("ngfStopPropagation")),f=1,p;r[0].addEventListener("dragover",function(y){if(k()||!s.shouldUpdateOn("drop",n,d))return;y.preventDefault(),i(d)&&y.stopPropagation();if(navigator.userAgent.indexOf("Chrome")>-1){var x=y.dataTransfer.effectAllowed;y.dataTransfer.dropEffect="move"===x||"linkMove"===x?"move":"copy"}v.cancel(u),p||(p="C",l(d,n,y,function(z){p=z,r.addClass(p),g("ngfDrag",d,{$isDragging:!0,$class:p,$event:y})}))},!1),r[0].addEventListener("dragenter",function(x){if(k()||!s.shouldUpdateOn("drop",n,d))return;x.preventDefault(),i(d)&&x.stopPropagation()},!1),r[0].addEventListener("dragleave",function(x){if(k()||!s.shouldUpdateOn("drop",n,d))return;x.preventDefault(),i(d)&&x.stopPropagation(),u=v(function(){p&&r.removeClass(p),p=null,g("ngfDrag",d,{$isDragging:!1,$event:x})},f||100)},!1),r[0].addEventListener("drop",function(x){if(k()||!s.shouldUpdateOn("drop",n,d))return;x.preventDefault(),i(d)&&x.stopPropagation(),p&&r.removeClass(p),p=null;var y=x.dataTransfer.items,z;try{z=x.dataTransfer&&x.dataTransfer.getData&&x.dataTransfer.getData("text/html")}catch(A){}t(y,x.dataTransfer.files,g("ngfAllowDir",d)!==!1,g("multiple")||g("ngfMultiple",d)).then(function(B){B.length?c(B,x):o("dropUrl",z).then(function(C){c(C,x)})})},!1),r[0].addEventListener("paste",function(x){navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&g("ngfEnableFirefoxPaste",d)&&x.preventDefault();if(k()||!s.shouldUpdateOn("paste",n,d))return;var z=[],A=x.clipboardData||x.originalEvent.clipboardData;if(A&&A.items)for(var y=0;y<A.items.length;y++)A.items[y].type.indexOf("image")!==-1&&z.push(A.items[y].getAsFile());z.length?c(z,x):o("pasteUrl",A).then(function(B){c(B,x)})},!1),navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&g("ngfEnableFirefoxPaste",d)&&(r.attr("contenteditable",!0),r.on("keypress",function(x){!x.metaKey&&!x.ctrlKey&&x.preventDefault()}))}function a(){var c=document.createElement("div");return"draggable"in c&&"ondrop"in c&&!/Edge\/12./i.test(navigator.userAgent)}ngFileUpload.directive("ngfDrop",["$parse","$timeout","$location","Upload","$http","$q",function(f,e,h,d,g,c){return{restrict:"AEC",require:"?ngModel",link:function(j,k,i,l){b(j,k,i,l,f,e,h,d,g,c)}}}]),ngFileUpload.directive("ngfNoFileDrop",function(){return function(c,d){a()&&d.css("display","none")}}),ngFileUpload.directive("ngfDropAvailable",["$parse","$timeout","Upload",function(e,d,c){return function(h,i,f){if(a()){var g=e(c.attrGetter("ngfDropAvailable",f));d(function(){g(h),g.assign&&g.assign(h,!0)})}}}])}(),ngFileUpload.service("UploadExif",["UploadResize","$q",function(e,c){function b(g,h,i,f){switch(h){case 2:return g.transform(-1,0,0,1,i,0);case 3:return g.transform(-1,0,0,-1,i,f);case 4:return g.transform(1,0,0,-1,0,f);case 5:return g.transform(0,1,1,0,0,0);case 6:return g.transform(0,1,-1,0,f,0);case 7:return g.transform(0,-1,-1,0,f,i);case 8:return g.transform(0,-1,1,0,0,i)}}function a(h){var k="",g=new Uint8Array(h),f=g.byteLength;for(var j=0;j<f;j++)k+=String.fromCharCode(g[j]);return window.btoa(k)}var d=e;return d.isExifSupported=function(){return window.FileReader&&(new FileReader).readAsArrayBuffer&&d.isResizeSupported()},d.readOrientation=function(h){var i=c.defer(),f=new FileReader,g=h.slice?h.slice(0,65536):h;return f.readAsArrayBuffer(g),f.onerror=function(j){return i.reject(j)},f.onload=function(o){var s={orientation:1},p=new DataView(this.result);if(p.getUint16(0,!1)!==65496)return i.resolve(s);var k=p.byteLength,l=2;while(l<k){var n=p.getUint16(l,!1);l+=2;if(n===65505){if(p.getUint32(l+=2,!1)!==1165519206)return i.resolve(s);var r=p.getUint16(l+=6,!1)===18761;l+=p.getUint32(l+4,r);var q=p.getUint16(l,r);l+=2;for(var m=0;m<q;m++)if(p.getUint16(l+m*12,r)===274){var j=p.getUint16(l+m*12+8,r);return j>=2&&j<=8&&(p.setUint16(l+m*12+8,1,r),s.fixedArrayBuffer=o.target.result),s.orientation=j,i.resolve(s)}}else{if((n&65280)!==65280)break;l+=p.getUint16(l,!1)}}return i.resolve(s)},i.promise},d.applyExifRotation=function(g){if(g.type.indexOf("image/jpeg")!==0)return d.emptyPromise(g);var f=c.defer();return d.readOrientation(g).then(function(h){if(h.orientation<2||h.orientation>8)return f.resolve(g);d.dataUrl(g,!0).then(function(k){var j=document.createElement("canvas"),i=document.createElement("img");i.onload=function(){try{j.width=h.orientation>4?i.height:i.width,j.height=h.orientation>4?i.width:i.height;var l=j.getContext("2d");b(l,h.orientation,i.width,i.height),l.drawImage(i,0,0);var o=j.toDataURL(g.type||"image/WebP",.934);o=d.restoreExif(a(h.fixedArrayBuffer),o);var m=d.dataUrltoBlob(o,g.name);f.resolve(m)}catch(n){return f.reject(n)}},i.onerror=function(){f.reject()},i.src=k},function(i){f.reject(i)})},function(h){f.reject(h)}),f.promise},d.restoreExif=function(h,g){var f={};return f.KEY_STR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",f.encode64=function(l){var j="",s,q,o="",r,p,n,m="",k=0;do s=l[k++],q=l[k++],o=l[k++],r=s>>2,p=(s&3)<<4|q>>4,n=(q&15)<<2|o>>6,m=o&63,isNaN(q)?n=m=64:isNaN(o)&&(m=64),j=j+this.KEY_STR.charAt(r)+this.KEY_STR.charAt(p)+this.KEY_STR.charAt(n)+this.KEY_STR.charAt(m),s=q=o="",r=p=n=m="";while(k<l.length);return j},f.restore=function(i,m){i.match("data:image/jpeg;base64,")&&(i=i.replace("data:image/jpeg;base64,",""));var l=this.decode64(i),j=this.slice2Segments(l),k=this.exifManipulation(m,j);return"data:image/jpeg;base64,"+this.encode64(k)},f.exifManipulation=function(l,k){var i=this.getExifArray(k),j=this.insertExif(l,i);return new Uint8Array(j)},f.getExifArray=function(k){var j;for(var i=0;i<k.length;i++){j=k[i];if(j[0]===255&j[1]===225)return j}return[]},f.insertExif=function(p,i){var o=p.replace("data:image/jpeg;base64,",""),k=this.decode64(o),j=k.indexOf(255,3),m=k.slice(0,j),l=k.slice(j),n=m;return n=n.concat(i),n=n.concat(l),n},f.slice2Segments=function(j){var m=0,k=[];for(;;){if(j[m]===255&j[m+1]===218)break;if(j[m]===255&j[m+1]===216)m+=2;else{var n=j[m+2]*256+j[m+3],l=m+n+2,i=j.slice(m,l);k.push(i),m=l}if(m>j.length)break}return k},f.decode64=function(m){var t,r,p="",s,q,o,n="",l=0,k=[],j=/[^A-Za-z0-9\+\/\=]/g;j.exec(m)&&console.log("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, NaNExpect errors in decoding."),m=m.replace(/[^A-Za-z0-9\+\/\=]/g,"");do s=this.KEY_STR.indexOf(m.charAt(l++)),q=this.KEY_STR.indexOf(m.charAt(l++)),o=this.KEY_STR.indexOf(m.charAt(l++)),n=this.KEY_STR.indexOf(m.charAt(l++)),t=s<<2|q>>4,r=(q&15)<<4|o>>2,p=(o&3)<<6|n,k.push(t),o!==64&&k.push(r),n!==64&&k.push(p),t=r=p="",s=q=o=n="";while(l<m.length);return k},f.restore(h,g)},d}]);