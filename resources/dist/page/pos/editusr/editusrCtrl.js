define(["posService"],function(){return["$scope","appConstant","ajaxService","modalService","$rootScope","$state","posService",function($scope,appConstant,ajaxService,modalService,$rootScope,$state,posService){$scope.displayValidateCode=!1;var tabData=$rootScope.cardoperatetoeditusrmemberinfo,data=angular.copy(tabData);$scope.member=data;var oldmobile=undefined==$scope.member.mobile?null:$scope.member.mobile;$scope.member.cardKind=$scope.member.cardKind+"",$scope.member.nation=$scope.member.nation+"",$scope.member.birthdayType="0",$scope.nationList=appConstant.nationList,$scope.cardKindList=appConstant.cardKindList,$scope.birthdayTypeList=appConstant.birthdayTypeList,$scope.member.birthdayStr=(new Date($scope.member.birthday)).getTime(),$scope.updateMember=function(member){member.birthday=(new Date(member.birthday)).getTime(),member.createTime=(new Date(member.createTime)).getTime(),member.updateTime=(new Date(member.updateTime)).getTime();var ifUpdateMobile=0;member.mobile==""&&oldmobile!==null&&oldmobile!==""&&(ifUpdateMobile=2),member.mobile!==""&&oldmobile!==null&&oldmobile!==""&&member.mobile!==oldmobile&&(ifUpdateMobile=1),member.mobile!==""&&oldmobile==null&&(ifUpdateMobile=3);var param={member:member,sessionId:$rootScope.sessionId,ifUpdateMobile:ifUpdateMobile,oldMobile:oldmobile,memberHomeBean:$rootScope.currentuserinfo};ajaxService.AjaxPost(param,"postrade/memberhome/modifyuserinfo.do").then(function(result){result.status&&(modalService.info({content:"更新成功!",type:"ok"}),$rootScope.paramValue=$rootScope.currentuserinfo.cardInfoBean.number,$state.go("pos.cardoperte.mainpage"))})},$scope.cancel=function(){posService.goBack()},$scope.validateMobile=function(){$scope.member.mobile&&$scope.member.mobile!=""&&/^(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$/.test($scope.member.mobile)&&$scope.member.mobile!==oldmobile?$scope.displayValidateCode=!0:$scope.displayValidateCode=!1},$scope.getValidateCode=function(){alert("发送验证码！")},$scope.checkValidateCode=function(code,phone){code==1234&&phone?(alert("验证成功！"),$scope.displayValidateCode=!1,$scope.member.validatCode=""):alert("验证失败！")}}]});