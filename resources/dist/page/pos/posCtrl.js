define(["angular","posTopbar"],function(angular,posTopbar){return["$scope","ajaxService","getCookieService","$rootScope","modalService","$state",function($scope,ajaxService,getCookieService,$rootScope,modalService,$state){angular.element(document.getElementsByTagName("body")[0]).css("background","#dee6f2"),$scope.userterminal=angular.copy($scope.terminal),$scope.usershopterminal=angular.copy($scope.shopterminals);var sessionId=getCookieService.getCookie("CRMSESSIONID"),data={sessionId:sessionId};ajaxService.AjaxPost(data,"postrade/memberhome/usershopcombo.do").then(function(result){result.data!=null&&($scope.usershopcombo=result.data)}),$scope.getShopTerminal=function(shopId){var search={shopId:shopId,sessionId:$rootScope.sessionId};$scope.userterminal.terminalId="",$scope.userterminal.terminaName="",$scope.userterminal.terminalCode="",$scope.userterminal.shopName=$('select[name="shopid"]').find("option:selected").text(),ajaxService.AjaxPost(search,"postrade/memberhome/usershopterminal.do").then(function(result){result.data!=null&&($scope.usershopterminal=result.data)})},$scope.confirmIn=function(){$scope.userterminal.sessionId=$rootScope.sessionId;var userterminal=$scope.userterminal;if(!userterminal.shopId||!userterminal.terminalId||!userterminal.shopName){modalService.info({title:"提示",content:"请选择终端！!",size:"sm",type:"confirm"});return}ajaxService.AjaxPost(userterminal,"postrade/memberhome/modifyuserterminal.do").then(function(result){result.status==1&&($scope.$parent.terminal=result,$scope.$parent.shopterminals=$scope.usershopterminal,$state.go("pos.selectedpos"))})},$scope.clickterminal=function(index,one){$scope.userterminal.terminalId=one.teminalId,$scope.userterminal.terminalCode=one.teminalCode,$scope.userterminal.terminaName=one.name},$scope.isPosHome=function(){return $state.current.name=="pos.selectedpos"?!1:!0},$scope.goselectedpos=function(){$rootScope.cardoperatetoeditusrmemberinfo=null,$rootScope.currentuserinfo=null,$state.go("pos.selectedpos")}}]});