define(["require","css!score_rule_css","css!trade_css","ngAMD"],function(require){var app=require("css!score_rule_css"),trade_css=require("css!trade_css"),ngAMD=require("ngAMD");return ngAMD.controller("tradeCtrl",["$scope","register","getCookieService","appConstant","$rootScope","ajaxService",function($scope,register,getCookieService,appConstant,$rootScope,ajaxService){var sessionId=$rootScope.sessionId,tradeTypeParam={sessionId:sessionId,pageCount:100},allDate=!0,toDay=!1,tradeTime=null,tradeTypeId=null;typeof $rootScope.searchRequest!="undefined"&&typeof $rootScope.searchRequest.select!="undefined"&&(tradeTypeId=1,$rootScope.searchRequest.select=="toDay"&&(allDate=!1,toDay=!0,tradeTime=0),$rootScope.searchRequest.select=="all"&&(allDate=!0,toDay=!1),tradeTypeParam.elementSelect=1),$scope.conditions={ajaxUrl:"trade/indexpage/list.do",request:{sessionId:sessionId,pageNo:"1",pageCount:appConstant.pageSet.numPerPage,tradeTime:tradeTime,tradeTypeId:tradeTypeId},filter:[{type:"dateFlex",field:"交易时间：",value:[{name:"全部",state:allDate,value:""},{name:"今天",state:toDay,value:0},{name:"昨天",state:!1,value:1},{name:"近7天",state:!1,value:7},{name:"近15天",state:!1,value:15},{name:"近30天",state:!1,value:30}],requestFiled:["tradeTime","startTradeTime","endTradeTime"]},{type:"normal",field:"交易类型：",requestFiled:"tradeTypeId",value:[],ajaxUrl:"trade/tradeType/list.do",request:tradeTypeParam}],select:{requestFiled:"searchType",options:[{name:"卡号",state:!1,value:1},{name:"手机号",state:!1,value:2},{name:"流水号",state:!0,value:3}]},search:{requestFiled:"searchTypeValue"}},$scope.pageSet={title:"交易列表",currentPage:appConstant.pageSet.currentPage,maxSize:appConstant.pageSet.maxSize,numPerPage:appConstant.pageSet.numPerPage},$scope.pageChanged=function(){var postObj=$scope.$$childTail.$$childHead.requestObj.request;postObj.pageNo=$scope.pageSet.currentPage,postObj.pageCount=$scope.pageSet.numPerPage,ajaxService.AjaxPost(postObj,$scope.conditions.ajaxUrl).then(function(result){$scope.$$childTail.$$childHead.resultList=result})},$scope.opentradeInfoPan=function(trade){trade.callback=function a(callback){callback()},register.addToTabs({title:"交易详情",id:"tradeinfo"+trade.txCode,template:"business/trademanage/tradeDetail.html",ctrl:"business/trademanage/tradeDetail",ctrlName:"tradeDetailCtrl",ng_show:!1,type:"single",from:10015},trade)},$scope.conditions1={ajaxUrl:"trade/indexpage/list.do",request:{sessionId:sessionId,pageNo:"1",pageCount:appConstant.pageSet.numPerPage},filter:[{type:"dateFlex",field:"交易时间",value:[{name:"全部",state:!0,value:0},{name:"昨天",state:!1,value:-1},{name:"今天",state:!1,value:1},{name:"最近7天",state:!1,value:7},{name:"最近15天",state:!1,value:15},{name:"最近30天",state:!1,value:30}],requestFiled:["tradeTime","startTradeTime","endTradeTime"]}]},$scope.pageSet1={title:"批量充值",currentPage:appConstant.pageSet.currentPage,maxSize:appConstant.pageSet.maxSize,numPerPage:appConstant.pageSet.numPerPage,button:{title:"软pos会员首页测试",newtab:{title:"会员首页",id:"memberHomeCtrl",template:"postrade/memberhome/memberHome.html",ctrlName:"memberHomeCtrl",ctrl:"postrade/memberhome/memberHome",from:10005,type:"multiple",ng_show:!1}},table:[{field:"createTime",desc:"交易时间"},{field:"txCode",desc:"流水号"},{field:"terminalCode",desc:"终端号"},{field:"operationName",desc:"操作员名称"},{field:"cardNo",desc:"卡号"},{field:"cardType",desc:"卡类型"},{field:"tradeType",desc:"交易类型"},{field:"openShopName",desc:"开卡门店"},{field:"xfShopName",desc:"交易门店"},{field:"userName",desc:"用户名"},{field:"userPhone",desc:"电话"}]}}]),"tradeCtrl"});