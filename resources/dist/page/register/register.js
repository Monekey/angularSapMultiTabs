define([],function(){return["$scope","appConstant","ajaxService","register","modalService","$state","$rootScope",function($scope,appConstant,ajaxService,register,modalService,$state,$rootScope){$rootScope.overlay=!0,$scope.forbideSave=!1,$scope.newUser={mobile:"",email:"",smsCode:"",name:"",password:"",repassword:"",showMobile:!0,isValidSmsCode:!1,isValidPassword:!1,isValidMobile:!1,isValidEmail:!1},$scope.taggleAccountType=function(isMobile){$scope.newUser.mobile="",$scope.newUser.email="",$scope.newUser.smsCode="",$scope.newUser.isValidSmsCode=!1,$scope.newUser.isValidMobile=!1,$scope.newUser.isValidEmail=!1,isMobile?$scope.newUser.showMobile=!0:$scope.newUser.showMobile=!1},$scope.validateEmailFormat=function(newUser){newUser.isValidEmail=!1,newUser.email&&/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(newUser.email)&&(newUser.isValidEmail=!0)},$scope.validateMobileFormat=function(newUser){newUser.isValidMobile=!1,newUser.mobile&&/^(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$/.test(newUser.mobile)&&(newUser.isValidMobile=!0)},$scope.getSellCardSmsCode=function(newUser){newUser.smsCode="",newUser.isValidSmsCode=!1,newUser.mobile&&newUser.mobile!=""&&/^(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$/.test(newUser.mobile)?ajaxService.AjaxPost({mobile:newUser.mobile},"common/sms/getSmsCode.do").then(function(result){result.status&&modalService.info({content:"发送验证码成功！",type:"ok"})}):modalService.info({title:"提示",content:"请输入11位手机号！",size:"sm",type:"confirm"})},$scope.checkSmsCode=function(newUser){newUser.isValidSmsCode=!1;if(newUser.smsCode&&newUser.smsCode!=""){var param={smsCode:newUser.smsCode,mobile:newUser.mobile};ajaxService.AjaxPost(param,"common/sms/checkSmsCode.do").then(function(result){result.status&&result.smsCodeStatus&&(newUser.isValidSmsCode=!0)})}},$scope.tipMsg={},$scope.validatePasswd=function(newUser){newUser.isValidPassword=!1;var result=!1;return/^[0-9a-zA-Z]{1,20}$/.test(newUser.repassword)?newUser.repassword!=newUser.password?($scope.tipMsg.repassword="两次输入密码不一致！",result=!0):newUser.isValidPassword=!0:($scope.tipMsg.repassword="请输入确认密码！",result=!0),result},$scope.saveUser=function(newUser){$scope.forbideSave=!0;if(newUser.showMobile){$scope.validateMobileFormat(newUser);if(!newUser.isValidMobile)return $scope.forbideSave=!1,modalService.info({title:"提示",content:"请输入11位手机号！",size:"sm",type:"confirm"}),!1}else{$scope.validateEmailFormat(newUser);if(!newUser.isValidEmail)return $scope.forbideSave=!1,modalService.info({title:"提示",content:"请输入有效邮箱！",size:"sm",type:"confirm"}),!1}if(!newUser.password||newUser.password=="")return $scope.forbideSave=!1,modalService.info({title:"提示",content:"密码不允许为空！",size:"sm",type:"confirm"}),!1;if(!newUser.repassword||newUser.repassword=="")return $scope.forbideSave=!1,modalService.info({title:"提示",content:"确认密码不允许为空！",size:"sm",type:"confirm"}),!1;if(newUser.repassword!=newUser.password)return $scope.forbideSave=!1,modalService.info({title:"提示",content:"两次输入的密码不一致！",size:"sm",type:"confirm"}),!1;ajaxService.AjaxPost(newUser,"register/registerUser.do").then(function(result){result.status?(modalService.info({content:"用户注册成功！",type:"ok"}),$state.go("login")):$scope.forbideSave=!1},function(data){$scope.forbideSave=!1})},$scope.goLogin=function(){$state.go("login")}}]});