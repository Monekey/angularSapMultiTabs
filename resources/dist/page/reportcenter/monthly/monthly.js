define(["require","css!score_rule_css","jquery","ngAMD"],function(require){var app=require("css!score_rule_css"),$=require("jquery"),ngAMD=require("ngAMD");return ngAMD.controller("monthCtrl",["$scope","getCookieService","appConstant","ajaxService","register",function($scope,getCookieService,appConstant,ajaxService,register){$scope.titleName="shopName";var sessionId=getCookieService.getCookie("CRMSESSIONID");$scope.conditions={ajaxUrl:"reportcenter/monthly/list.do",request:{sessionId:sessionId,pageNo:"1",pageCount:appConstant.pageSet.numPerPage},filter:[{type:"normal",field:"卡型：",requestFiled:"cardTypeId",value:[],ajaxUrl:"memberequity/cardtype/list.do",request:{sessionId:sessionId}}],datePicker:{requestFiled:["date","month"],value:[{name:"本月",state:!0,value:"M0"},{name:"上月",state:!1,value:"M1"}]},more:!0},changeGroup=function(obj){var index=obj.selectedIndex,groupBy=obj.options[index].value,postObj=$scope.requestObj.request;postObj.pageNo=$scope.pageSet.currentPage,postObj.pageCount=$scope.pageSet.numPerPage,postObj.groupBy=groupBy,groupBy=="shop"&&($("#titleName").text("门店"),$scope.titleName="shopName"),groupBy=="city"&&($("#titleName").text("城市"),$scope.titleName="cityName"),groupBy=="brand"&&($("#titleName").text("品牌"),$scope.titleName="brandName"),ajaxService.AjaxPost(postObj,$scope.conditions.ajaxUrl).then(function(result){$scope.resultList=result})},$scope.getValue=function(value){return value==null?0:value},$scope.pageSet={title:"列表",currentPage:appConstant.pageSet.currentPage,maxSize:appConstant.pageSet.maxSize,numPerPage:appConstant.pageSet.numPerPage},$scope.pageChanged=function(){var postObj=$scope.requestObj.request;postObj.pageNo=$scope.pageSet.currentPage,postObj.pageCount=$scope.pageSet.numPerPage,ajaxService.AjaxPost(postObj,$scope.conditions.ajaxUrl).then(function(result){$scope.resultList=result})},$scope.openSaveMoney=function(shop,flag){var postObj=$scope.requestObj.request;for(var x in postObj)shop[x]=postObj[x];shop.isOtherShop=flag;try{shop.date=$scope.requestObj.request.date}catch(e){shop.date=0}shop.shopId=shop.id,register.addToTabs({title:"储值明细",id:"saveMoneyDesc"+shop.id,template:"reportcenter/savemoney/saveMoneyDesc.html",ctrl:"reportcenter/savemoney/saveMoneyDesc",ctrlName:"saveMoneyDesc",ng_show:!1,type:"single",from:1001},shop)},$scope.openConsume=function(shop,flag){var postObj=$scope.requestObj.request;for(var x in postObj)shop[x]=postObj[x];shop.isOtherShop=flag;try{shop.date=$scope.requestObj.request.date}catch(e){shop.date=0}shop.shopId=shop.id,register.addToTabs({title:"消费明细",id:"memberConsume"+shop.id,template:"reportcenter/savemoney/memberConsume.html",ctrl:"reportcenter/savemoney/memberConsume",ctrlName:"memberConsume",ng_show:!1,type:"single",from:1001},shop)}}]),"monthCtrl"});