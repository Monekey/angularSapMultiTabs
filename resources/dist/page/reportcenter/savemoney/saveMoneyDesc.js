var index=0;define(["require","ngAMD","angular","uploadService","echart","macarons"],function(require){var ngAMD=require("ngAMD"),angular=require("angular"),upload=require("uploadService"),echart=require("echart"),macarons=require("macarons");echart.registerTheme("macarons",macarons),ngAMD.controller("saveMoneyDesc",["$scope","appConstant","ajaxService","register","uploadService","$rootScope",function($scope,appConstant,ajaxService,register,uploadService,$rootScope){index+=1,$scope.index=index;var sessionId=$rootScope.sessionId,tabData=$rootScope.TabsData,data=angular.copy(tabData);$scope.shop=data,$scope.from=data.from;var param={};for(var x in data)param[x]=data[x];param.sessionId=sessionId,param.name="getSaveMonryQuery",param.pageNo="1",param.pageCount=appConstant.pageSet.numPerPage,param.otherShop=data.isOtherShop,$scope.conditions={ajaxUrl:"reportcenter/compDetailed/list.do",request:param,filter:[{type:"normal",field:"终端",requestFiled:"terminalId",value:[],ajaxUrl:"reportcenter/terminal/list.do",request:param}]},$scope.pageSet={title:"储值明细表",currentPage:appConstant.pageSet.currentPage,maxSize:appConstant.pageSet.maxSize,numPerPage:appConstant.pageSet.numPerPage,table:[{field:"index",desc:"编号"},{field:"ts_code",desc:"流水号",column:"ts_code"},{field:"member_name",desc:"姓名"},{field:"number",desc:"卡号"},{field:"typename",desc:"卡类型",column:"typename"},{field:"value",desc:"储值本金(元)"},{field:"zongsongjine",desc:"储值赠送金额(元)"},{field:"opname",desc:"操作类型",column:"opname"},{field:"ts_type_name",desc:"付款方式"},{field:"createTime",desc:"操作时间",column:"createTime"},{field:"terminal_code",desc:"终端号"},{field:"operation_name",desc:"操作人",column:"operation_name"},{field:"open_shop_name",desc:"开卡门店"},{field:"xf_shop_name",desc:"交易门店"}]},$scope.setPie=function(documentId,result){try{var param=new Array;for(var i=1;i<result.data.length;i++)param[i-1]=result.data[i];var myChart1=echart.init(document.getElementById(documentId),"macarons");myChart1.clear(),option1={title:{text:"付款方式分布",x:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},calculable:!0,series:[{name:"支付方式",type:"pie",radius:"55%",center:["50%","60%"],data:param,itemStyle:{emphasis:{shadowColor:"rgba(0, 0, 0, 0.5)"}}}]},myChart1.setOption(option1)}catch(e){}},ajaxService.AjaxPost(param,"reportcenter/compDetailed/load.do").then(function(result){$scope.data=result.data,$scope.bishu=result.data[0].bishu,$scope.benjin=result.data[0].value,$scope.zengsongjine=result.data[0].zengsongjine;var name="bttype"+index;$scope.setPie(name,result)})}])});